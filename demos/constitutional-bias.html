<!doctype html><html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Constitutional Bias Dashboard — ETHRAEON</title><link rel="stylesheet" href="/assets/brand.css">
<body><div class="container">
  <div class="hero"><div class="logo"></div><div><h1>Constitutional Bias Dashboard</h1>
    <div class="small">Monitor outputs vs. policy; spot drifts; export audits.</div></div></div>

  <div class="card"><div class="badge">INTERACTIVE</div>
    <h2>What this shows</h2><p class='small'>Click <b>Simulate new run</b> to reseed pass/fail and see how audits export. Copy JSON/CSV to hand an audit bundle to compliance.</p><button id='btnSim'>Simulate new run</button>
    <ul>
      <li>Policy checks pass/fail + rationale.</li>
      <li>Summary compliance metric.</li>
      <li>One-click copy: JSON or CSV (no file hunting).</li>
    </ul>
    <div id="bias" class="small" style="margin-top:12px">Loading…</div>
  </div>

  <script src="/assets/demo.js"></script>
<script>
function toCSV(rows){
  const head = ["status","policy","details"];
  const esc = v => `"${String(v).replace(/"/g,'""')}"`;
  return [head.join(","), ...rows.map(t=>[t.pass?'PASS':'FAIL', t.policy, t.details].map(esc).join(","))].join("\n");
}
function copy(txt){ navigator.clipboard.writeText(txt).then(()=>alert('Copied.')); }

loadJSON('/data/bias.json').then(d=>{
  const pass = d.tests.filter(t=>t.pass).length;
  const total = d.tests.length;
  const summary = `Policies met: ${pass}/${total} • ${Math.round(pass/total*100)}% compliance`;
  document.querySelector('#bias').innerHTML = `
    <div class="card">
      <b>Summary:</b> ${summary}<br>
      <div style="margin-top:8px">
        <button id="btnCopyJSON">Copy JSON</button>
        <button id="btnCopyCSV">Copy CSV</button>
      </div>
    </div>
    <div style="margin-top:8px"></div>
    ${d.tests.map(t=>`
      <div class="card" style="margin:8px 0">
        <b>Status:</b> ${t.pass?'PASS':'FAIL'} &nbsp; <b>Policy:</b> ${t.policy}<br>
        <b>Details:</b> ${t.details}
      </div>`).join('')}
  `;
  function toCSV(arr){ const head=['status','policy','details']; const rows=arr.map(t=>[(t.pass?'PASS':'FAIL'),t.policy,t.details]); return [head.join(','), *[r.join(',') for r in rows]].join('\n'); }
document.querySelector('#btnCopyJSON').onclick = ()=>copy(JSON.stringify(d.tests, null, 2));
  document.querySelector('#btnCopyCSV').onclick  = ()=>copy(toCSV(d.tests));
  const sim=document.getElementById('btnSim'); if(sim){ sim.onclick=reshuffle; }
});
</script>
</body>
</html>

<!doctype html><html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Constitutional Bias Dashboard — ETHRAEON</title><link rel="stylesheet" href="/assets/brand.css">
<body><div class="container">
  <div class="hero"><div class="logo"></div><div><h1>Constitutional Bias Dashboard</h1>
    <div class="small">Monitor outputs vs. policy; spot drifts; export audits.</div></div></div>

  <div class="card"><div class="badge">INTERACTIVE</div>
    <h2>What this shows</h2>
    <ul>
      <li>Policy checks pass/fail + rationale.</li>
      <li>Summary compliance metric.</li>
      <li>One-click copy: JSON or CSV (no file hunting).</li>
    </ul>
    <div id="bias" class="small" style="margin-top:12px">Loading…</div>
  </div>

  <dialog id="rawDlg" style="max-width: 720px;"><div style="white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, monospace" id="rawTxt"></div>
    <div style="margin-top:12px; text-align:right"><button onclick="document.querySelector('#rawDlg').close()">Close</button></div>
  </dialog>

  <p class="small">Status: Interactive demo with simulated data.</p>
</div>
<script src="/assets/demo.js"></script>
<script>
function toCSV(rows){
  const head = ["status","policy","details"];
  const esc = v => `"${String(v).replace(/"/g,'""')}"`;
  return [head.join(","), ...rows.map(t=>[t.pass?'PASS':'FAIL', t.policy, t.details].map(esc).join(","))].join("\n");
}
function copy(txt){ navigator.clipboard.writeText(txt).then(()=>alert('Copied.')); }

loadJSON('/data/bias.json').then(d=>{
  const pass = d.tests.filter(t=>t.pass).length, total = d.tests.length;
  const summary = `Policies met: ${pass}/${total} • ${Math.round(pass/total*100)}% compliance`;

  const rows = d.tests.map(t=>`
    <tr>
      <td>${t.pass?'PASS':'FAIL'}</td>
      <td>${t.policy}</td>
      <td>${t.details}</td>
    </tr>`).join('');

  document.querySelector('#bias').innerHTML = `
    <div class="card">
      <b>Summary:</b> ${summary}<br>
      <div style="margin-top:8px">
        <button id="btnCopyJSON">Copy JSON</button>
        <button id="btnCopyCSV">Copy CSV</button>
        <button id="btnViewJSON">View raw JSON</button>
      </div>
    </div>
    <table class="small" style="width:100%; margin-top:10px">
      <thead><tr><th>Status</th><th>Policy</th><th>Details</th></tr></thead>
      <tbody>${rows}</tbody>
    </table>
  `;
  document.querySelector('#btnCopyJSON').onclick = ()=>copy(JSON.stringify(d.tests,null,2));
  document.querySelector('#btnCopyCSV').onclick  = ()=>copy(toCSV(d.tests));
  document.querySelector('#btnViewJSON').onclick = ()=>{
    document.querySelector('#rawTxt').textContent = JSON.stringify(d.tests, null, 2);
    document.querySelector('#rawDlg').showModal();
  };
});
</script>
</body></html>

<!doctype html><html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Field Triage Dashboard — ETHRAEON</title><link rel="stylesheet" href="/assets/brand.css">
<body><div class="container">
  <div class="hero"><div class="logo"></div><div><h1>Field Triage Dashboard</h1>
  <div class="small">Intake → classify → safe actions. Governance baked in.</div></div></div>

  <div class="card">
  <div class="badge">LIVE</div>
  <h2>Open a case (20 seconds)</h2>
  <form id="triageForm">
  <label class="small" for="category">Category</label>
  <select id="category" style="width:100%;margin:4px 0 8px">
    <option>Safety</option>
    <option>Data leak</option>
    <option>Harassment</option>
    <option>Brand risk</option>
    <option>Other</option>
  </select>

  <label class="small" for="summary">Summary (one sentence)</label>
  <textarea id="summary" rows="3" style="width:100%;margin:4px 0 12px" placeholder="Brief summary of the incident"></textarea>

  <label class="small" for="caseId">Case ID (optional)</label>
  <input id="caseId" style="width:100%;margin:4px 0 8px" placeholder="Leave blank to auto-create">

  <button id="submitBtn">Submit</button>
  <span id="submitMsg" class="small" style="margin-left:8px"></span>
</form>
</div>

<div class="card">
<h2 style="margin-top:16px">Recent cases (live)</h2>
<div id="recent" class="small">Loading…</div>
<script>
async function loadRecent(){
  const r = await fetch('/.netlify/functions/list_cases');
  const d = await r.json().catch(()=>({cases:[]}));
  const html = (d.cases||[]).map(c=>`<div class="card" style="margin:8px 0">
    <b>${c.case_id}</b> — ${c.summary}<br><span class="muted">${new Date(c.created_at).toLocaleString()}</span>
  </div>`).join('') || 'No cases yet.';
  document.querySelector('#recent').innerHTML = html;
}
loadRecent();
</div>

<script src="/assets/demo.js"></script>
<script>
document.getElementById('triageForm').onsubmit = async (e)=>{
  e.preventDefault();
  const summary = document.getElementById('summary').value.trim();
  const category = document.getElementById('category').value;
  if(!summary) { document.getElementById('submitMsg').textContent='Summary required.'; return; }
  const caseId = document.getElementById('caseId').value.trim() || `INC-${Date.now().toString().slice(-6)}`;
  const payload = { caseId, summary, category };
}
</script>
</body></html>
